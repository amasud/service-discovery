# Service Discovery — Gap Tracker

## Open Issues

### Step 1: Supply Analysis
- [ ] Report name should be required field
- [ ] Limit is hardcoded to 10 — needs UI control for KB and catalog limits separately
- [ ] Long-running analysis needs async execution (Flow Designer) for large datasets

### Step 2: Registry
- [ ] Edit/rename company and product names
- [ ] Merge duplicate products
- [ ] Show record counts by type (how many KB, catalog, incidents per product)

### Step 3: Supply Results
- [ ] Catalog items with no product show under "(No product identified)" — review if this is helpful
- [ ] Need ability to manually reassign a classification to a different topic/product

### Step 4: Demand Analysis
- [ ] Date filters and assignment group filters not yet passed to NASK call
- [ ] Limit options (50/100/250/500) need to work — currently hardcoded
- [ ] Timeout risk for large batches — 50 incidents × 3 sec = 2.5 min

### Step 5: New Products
- [ ] Shows "No unmatched products" even when many incidents have no product — needs to also show incidents without products grouped by topic for review
- [ ] "Add to registry" and "Ignore" buttons not wired up

### Step 6: Analyze Results
- [ ] Coverage rule save works but doesn't refresh gap status in UI immediately
- [ ] Some incidents about domain-specific apps (360 Operations, FM2) not in taxonomy — consider "Other/Uncategorized" bucket
- [ ] Need export capability (CSV/Excel)

### Registry (Global)
- [ ] Edit/rename not implemented
- [ ] No way to merge two products into one

### Reports
- [ ] Report detail view just loads gaps — should show the specific run's data
- [ ] No way to delete old reports/runs

### NASK Skills
- [ ] Demand skill test values should be cleared (same fix as supply)
- [ ] Demand prompt should match supply prompt improvements
- [ ] Consider adding "360 Operations", "FM2" etc. to taxonomy based on incident patterns

## Completed
- [x] NASK skills created and tested (SDClassifySupply, SDClassifyDemand)
- [x] Skills wired into widget — buttons invoke real AI
- [x] Payload format fixed (Format B: direct payload)
- [x] Test values cleared from supply skill inputs
- [x] Prompt improved: no hallucinated products, honest confidence
- [x] Deduplication: skip already-classified records
- [x] Source_type case normalization
- [x] Boolean field comparison fixed (verified, active)
- [x] Registry confirm/confirmed visual state working
- [x] Hide/unhide with soft delete (u_active field)
- [x] Show Hidden toggle
- [x] 6-step guided flow
- [x] Company → Product → Topic hierarchy
- [x] Clickable counts with records drill-down modal
- [x] Coverage rule modal with save
- [x] Taxonomy expanded: 50 topics, 19 categories
- [x] Data model: coverage rules table, extracted fields, active field
- [x] "(No product identified)" instead of filtering out unassigned

## Next Session Priorities
1. Step 5: Show incidents without products for review
2. Run larger demand analysis and validate
3. Edit/rename on registry
4. Pass filter parameters to demand analysis
5. Async execution for large batches
6. Demand skill prompt improvements + clear test values
